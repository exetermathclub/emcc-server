$(function(){function g(a){var e=$("<tr>").append($("<td class='team_id'>").text(a[0])).append($("<td class='team_coach'>").text(a[1])).append($("<td class='team_name'>").text(a[2])).append($("<td class='team_members'>").text(1===a[6]?"<INDIVIDUAL>":JSON.parse(a[3]).join(", "))).append($("<td class='team_participation'>").text(a[5]?"On-Site":"Online")).append($("<td class='team_payment'>").append((a[4]?$("<input type='checkbox'/>").attr("checked",""):$("<input type='checkbox'/>")).addClass("payment_checkbox").click(function(){$.ajax({url:"../wsgi-scripts/toggle_payment.py",
data:{teamid:JSON.stringify(encrypt(d,a[0].toString())),id:b,paid:this.checked?1:0},success:function(a){a.success||alert("Action failed")}})}))).append($("<td class='team_deletion'>").append($("<button class='field'>").text("Delete").click(function(){confirm("Are you sure you want to delete "+a[2]+"?")&&$.ajax({url:"../wsgi-scripts/delete_team.py",data:{teamid:JSON.stringify(encrypt(d,a[0].toString())),id:b},success:function(){e.remove()}})})));return e}var f=localStorage.SRP_SESS_KEY,b=localStorage.SRP_ID,
d;f&&b?(d=CryptoJS.enc.Base64.parse(f),$.ajax({url:"../wsgi-scripts/admin_teams.py",method:"GET",data:{id:b},dataType:"json",success:function(a){a=JSON.parse(decrypt(d,a));var b=$("#team_table"),c;for(c=0;c<a.length;c+=1)b.append(g(a[c]))},error:function(){localStorage.removeItem("SRP_SESS_KEY");localStorage.removeItem("SRP_ID");window.location.href="login.shtml"}})):window.location.href="login.shtml"});
