window.JSON||(window.JSON={stringify:function(e){if(e instanceof Object){var l="";if(e.constructor===Array){for(var n=0;n<e.length;l+=this.stringify(e[n])+",",n++);return"["+l.substr(0,l.length-1)+"]"}if(e.toString!==Object.prototype.toString)return'"'+e.toString().replace(/"/g,"\\$&")+'"';for(n in e)l+='"'+n.replace(/"/g,"\\$&")+'":'+this.stringify(e[n])+",";return"{"+l.substr(0,l.length-1)+"}"}return"string"===typeof e?'"'+e.replace(/"/g,"\\$&")+'"':String(e)}});
$(function(){function e(b){var d=g[b];b===h?"none"!==m.css("display")?(A(),m.hide()):m.show():(h=b,z.show(),q.show(),m.detach(),r.val(d.name),y.each(function(b){this.value=d.members[b]}),B.text(d.paid?"Paid":"Unpaid"),s.val(d.participation?"On-Site":"Online"),t=d.individual,u.prop("checked",t),t?(v.hide(),w.show()):(v.show(),w.hide()),p[b].after(m),m.show())}function l(b){var d=e;a:{var f;for(f=0;f<p.length;f+=1)if(b.target===p[f][0]){b=f;break a}b=void 0}d(b)}function n(b){var d=r.val(),f=[],e="";
y.each(function(){f.push(this.value)});e=("On-Site"===s.val()).toString();return"edit"===b?{purpose:b,id:x[h],name:d,members:JSON.stringify(f),participation:e,individual:u.prop("checked")?"true":"false"}:{purpose:b,name:d,members:JSON.stringify(f),participation:e,individual:u.prop("checked")?"true":"false"}}function D(){var b;ga("send","event","button","team");$.ajax({url:"../wsgi-scripts/teams.py",method:"POST",data:n("register"),success:function(d){b=d.id}});return b}function A(){$.ajax({url:"../wsgi-scripts/teams.py",
method:"POST",data:n("edit")});g[h].name=r.val();g[h].members=members;g[h].participation="On-Site"===s.val();g[h].individual=u.prop("checked");p[h].text(r.val())}var g,p=[],x=[],t=!1,h=-1,C=$("#team_list"),m=$("#team_edit_pane"),y=$(".team_member"),B=$("#paid"),s=$("#participation"),r=$("#team_name"),q=$("#new"),z=$("#delete"),u=$("#individual_checkbox"),v=$(".hide_when_indiv"),w=$(".show_when_indiv");$.ajax({url:"../wsgi-scripts/teams.py",method:"GET",data:{purpose:"list"},success:function(b){var d;
g=b.teams;for(b=0;b<g.length;b+=1)x[b]=g[b].id,d=$("<div>").addClass("team").text(g[b].name).click(l),p.push(d),C.append(d)}});$("#save").click(function(){var b=[],d,f=x.length;y.each(function(){b.push(this.value)});-1===h?(d=D(),x[f]=d,g[f]={id:d,name:r.val(),members:b,participation:"On-Site"===s.val(),paid:!1},d=$("<div>").addClass("team").text(g[f].name).click(l),p.push(d),C.append(d),q.show()):A();m.hide()});z.click(function(){confirm("Are you sure you want to delete this team?")&&($.ajax({url:"../wsgi-scripts/teams.py",
method:"POST",data:{purpose:"delete",id:x[h]}}),delete g[h],p[h].remove(),p.splice(h,1),m.hide())});$("#cancel").click(function(){q.show();m.hide()});u.click(function(){(t=$(this).prop("checked"))?(v.hide(),w.show()):(v.show(),w.hide())});q.click(function(){h=-1;t=!1;v.show();w.hide();z.hide();r.val("");y.each(function(){this.value=""});B.text("Unpaid");s.val("On-Site");q.after(m);q.hide();m.show()});$.getJSON("../wsgi-scripts/getscores.py",function(b){var d,f=$("#scores"),e,a,c,h,g,k;for(h=0;h<b.length;h+=
1){d=b[h];k=$("<tbody>");f.append($("<h2>").text(d.name));c=$("<tr>");c.append($("<th>"));f.append($("<h3>").text("Speed"));for(a=1;25>=a;a+=1)c.append($("<th>").text(a));c.append($("<th>").text("Speed Total"));k.append(c);for(g=0;g<d.members.length;g+=1){e=d.members[g];c=$("<tr>");c.append($("<td>").text(e.name));for(a=1;25>=a;a+=1)c.append($("<td>").text(+e.speed_scores[a]));c.append($("<td>").text(e.speed_score));k.append(c)}f.append($("<table>").append(k));k=$("<tbody>");f.append($("<h3>").text("Accuracy"));
c=$("<tr>");c.append($("<th>"));for(a=1;10>=a;a+=1)c.append($("<th>").text(a));c.append($("<th>").text("Accuracy Total"));k.append(c);for(g=0;g<d.members.length;g+=1){e=d.members[g];c=$("<tr>");c.append($("<td>").text(e.name));for(a=1;10>=a;a+=1)c.append($("<td>").text(+e.accuracy_scores[a]));c.append($("<td>").text(e.accuracy_score));k.append(c)}f.append($("<table>").append(k));k=$("<tbody>");c=$("<tr>");f.append($("<h3>").text("Team"));for(a=1;10>=a;a+=1)c.append($("<th>").text(a));c.append($("<th>").text("Team Total"));
k.append(c);c=$("<tr>");for(a=1;10>=a;a+=1)c.append($("<td>").text(+d.team_scores[a]));c.append($("<td>").text(d.team_score));k.append(c);f.append($("<table>").append(k));k=$("<tbody>");c=$("<tr>");f.append($("<h3>").text("Guts"));for(a=1;24>=a;a+=1)c.append($("<th>").text(a));c.append($("<th>").text("Guts Total"));k.append(c);c=$("<tr>");for(a=1;24>=a;a+=1)c.append($("<td>").text(+d.guts_scores[a]));c.append($("<td>").text(d.guts_score));k.append(c);f.append($("<table>").append(k))}});$.ajax({url:"../wsgi-scripts/checkemail.py",
method:"GET",dataType:"json",success:function(b){b.success||1!==b.error?0===b.error&&(window.location.href="login.shtml"):($(".dialog").show(),$(".cover").show(),$("#dialog_submit").click(function(){-1<$("#dialog_input").val().indexOf("@")?$.ajax({url:"../wsgi-scripts/modify.py",method:"POST",data:{info:JSON.stringify({2:$("#dialog_input").val()})},success:function(){$(".dialog").hide();$(".cover").hide()}}):$("#dialog_tip").text("Please enter a valid email.")}))}})});
